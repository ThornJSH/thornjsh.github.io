<div class="content-section">
    <div class="intro-box" style="margin-bottom: 30px; text-align: center;">
        <h2 style="font-size: 2rem; margin-bottom: 10px; color: #333;">í›„ì› ì‹ ì²­ì„œ</h2>
        <p style="font-size: 1rem; color: #666;">ë”°ëœ»í•œ ë§ˆìŒì„ ë‚˜ëˆ„ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì•„ë˜ ë‚´ìš©ì„ ì‘ì„±í•´ ì£¼ì„¸ìš”.</p>
    </div>

    <form id="donationForm" class="styled-form">

        <!-- ì„¹ì…˜ 1: ê¸°ë¶€ì ì •ë³´ -->
        <div class="form-section">
            <h3 class="section-title">ğŸ‘¤ ê¸°ë¶€ì ì •ë³´</h3>
            <div class="form-grid">
                <!-- ì´ë¦„ & ì°¾ê¸° ë²„íŠ¼ -->
                <div class="form-group">
                    <label for="name">ì´ë¦„ <span class="required">*</span></label>
                    <div class="input-with-button">
                        <input type="text" id="name" name="name" placeholder="ì„±ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                        <button type="button" onclick="autofillForm()" class="btn-check">ê¸°ì¡´ì •ë³´ ì°¾ê¸°</button>
                    </div>
                </div>

                <!-- ì„±ë³„ -->
                <div class="form-group">
                    <label>ì„±ë³„</label>
                    <div class="radio-group">
                        <label class="radio-label"><input type="radio" name="gender" value="ë‚¨"> <span>ë‚¨ì</span></label>
                        <label class="radio-label"><input type="radio" name="gender" value="ì—¬"> <span>ì—¬ì</span></label>
                    </div>
                </div>

                <!-- ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ -->
                <div class="form-group full-width">
                    <label>ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ <span class="required">*</span></label>
                    <div class="ssn-group">
                        <input type="text" id="ssn_a" name="ssn_a" maxlength="6" placeholder="ì• 6ìë¦¬">
                        <span class="dash">-</span>
                        <input type="password" id="ssn_b" name="ssn_b" maxlength="7" placeholder="ë’¤ 7ìë¦¬" required>
                    </div>
                </div>

                <!-- ì—°ë½ì²˜ -->
                <div class="form-group">
                    <label for="cphone_n">íœ´ëŒ€ì „í™” <span class="required">*</span> <small>(ìˆ«ìë§Œ)</small></label>
                    <input type="text" id="cphone_n" name="cphone_n" maxlength="11" placeholder="01012345678">
                </div>
                <div class="form-group">
                    <label for="phone_n">ì¼ë°˜ì „í™” <small>(ìˆ«ìë§Œ)</small></label>
                    <input type="text" id="phone_n" name="phone_n" maxlength="11" placeholder="021234567">
                </div>

                <!-- ì£¼ì†Œ & ì´ë©”ì¼ -->
                <div class="form-group full-width">
                    <label for="address">ì£¼ì†Œ</label>
                    <input type="text" id="address" name="address" placeholder="ë„ë¡œëª… ì£¼ì†Œ ë“±">
                </div>
                <div class="form-group full-width">
                    <label for="e_mail">ì´ë©”ì¼</label>
                    <input type="text" id="e_mail" name="e_mail" placeholder="example@email.com">
                </div>
            </div>
        </div>

        <!-- ì„¹ì…˜ 2: í›„ì› ìƒì„¸ ì •ë³´ -->
        <div class="form-section">
            <h3 class="section-title">ğŸ’¸ í›„ì› ìƒì„¸ ë‚´ìš©</h3>
            <div class="form-grid">
                <!-- í›„ì› ë°©ì‹ -->
                <div class="form-group">
                    <label>í›„ì›ë°©ì‹</label>
                    <div class="radio-group">
                        <label class="radio-label"><input type="radio" name="s_term" value="ì •ê¸°"> <span>ì •ê¸°</span></label>
                        <label class="radio-label"><input type="radio" name="s_term" value="ë¹„ì •ê¸°">
                            <span>ë¹„ì •ê¸°</span></label>
                    </div>
                </div>

                <!-- í›„ì› êµ¬ë¶„ -->
                <div class="form-group">
                    <label>í›„ì›êµ¬ë¶„</label>
                    <div class="radio-group">
                        <label class="radio-label"><input type="radio" name="s_type" value="ì§€ì •"> <span>ì§€ì •</span></label>
                        <label class="radio-label"><input type="radio" name="s_type" value="ë¹„ì§€ì •">
                            <span>ë¹„ì§€ì •</span></label>
                    </div>
                </div>

                <!-- í›„ì›ê¸ˆ -->
                <div class="form-group">
                    <label for="s_money">í›„ì›ê¸ˆ(ì›)</label>
                    <input type="text" id="s_money" name="s_money" placeholder="ê¸ˆì•¡ ì…ë ¥">
                </div>

                <!-- í›„ì› ë°©ë²• -->
                <div class="form-group full-width">
                    <label>í›„ì›ë°©ë²•</label>
                    <div class="radio-group wrap">
                        <label class="radio-label"><input type="radio" name="s_how" value="ìë™ì´ì²´">
                            <span>ìë™ì´ì²´</span></label>
                        <label class="radio-label"><input type="radio" name="s_how" value="í˜„ê¸ˆë‚©ë¶€">
                            <span>í˜„ê¸ˆë‚©ë¶€</span></label>
                        <label class="radio-label"><input type="radio" name="s_how" value="CMS"> <span>CMS
                                ì´ì²´</span></label>
                        <label class="radio-label"><input type="radio" name="s_how" value="ê¸°íƒ€"> <span>ê¸°íƒ€</span></label>
                    </div>
                </div>

                <!-- í›„ì›í’ˆ (ë³µí•© ì…ë ¥) -->
                <div class="form-group full-width box-group">
                    <label>í›„ì›í’ˆ (ë¬¼í’ˆ í›„ì› ì‹œ ì‘ì„±)</label>
                    <div class="item-inputs">
                        <input type="text" id="s_item" name="s_item" placeholder="í’ˆëª…">
                        <input type="number" id="s_item_q" name="s_item_q" placeholder="ìˆ˜ëŸ‰">
                        <select id="s_unit" name="s_unit">
                            <option value="">ë‹¨ìœ„ ì„ íƒ</option>
                            <option value="ê°œ">ê°œ</option>
                            <option value="ì„¸íŠ¸">ì„¸íŠ¸</option>
                            <option value="Box">Box</option>
                            <option value="ê±´">ê±´</option>
                            <option value="Kg">Kg</option>
                            <option value="ëª…">ëª…</option>
                            <option value="í¬">í¬</option>
                            <option value="g">g(ê·¸ë¨)</option>
                            <option value="ë¦¬í„°">ë¦¬í„°</option>
                            <option value="ëŒ€">ëŒ€</option>
                            <option value="ì¥">ì¥</option>
                            <option value="í†µ">í†µ</option>
                            <option value="íŒ">íŒ</option>
                            <option value="ë³‘">ë³‘</option>
                            <option value="ë§ˆë¦¬">ë§ˆë¦¬</option>
                            <option value="ë´‰ì§€">ë´‰ì§€</option>
                            <option value="íŒ©">íŒ©</option>
                            <option value="ë¬¶ìŒ">ë¬¶ìŒ</option>
                            <option value="ê·¸ë£¨">ê·¸ë£¨</option>
                            <option value="ì†¡ì´">ì†¡ì´</option>
                            <option value="í¬ê¸°">í¬ê¸°</option>
                            <option value="ìë£¨">ìë£¨</option>
                            <option value="ì¸ë¶„">ì¸ë¶„</option>
                            <option value="ì§">ì§</option>
                            <option value="í¬ëŒ€">í¬ëŒ€</option>
                            <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                        </select>
                    </div>
                </div>

                <!-- í›„ì›ë¶„ì•¼ -->
                <div class="form-group">
                    <label for="s_sector">í›„ì›ë¶„ì•¼</label>
                    <select id="s_sector" name="s_sector">
                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="ë°‘ë°˜ì°¬ì§€ì›">ë°‘ë°˜ì°¬ì§€ì›</option>
                        <option value="ì €ì†Œë“ë…¸ì¸ ë¬´ë£Œê¸‰ì‹ì‚¬ì—…">ì €ì†Œë“ë…¸ì¸ ë¬´ë£Œê¸‰ì‹ì‚¬ì—…</option>
                        <option value="ìœ„ê¸° ë° ì·¨ì•½ë…¸ì¸ ì‚¬ì—…">ìœ„ê¸° ë° ì·¨ì•½ë…¸ì¸ ì‚¬ì—…</option>
                        <option value="ì§€ì—­ë³µì§€ ì—°ê³„ì‚¬ì—…">ì§€ì—­ë³µì§€ ì—°ê³„ì‚¬ì—…</option>
                        <option value="ëª…ì ˆ ì •ë‚˜ëˆ” í–‰ì‚¬">ëª…ì ˆ ì •ë‚˜ëˆ” í–‰ì‚¬</option>
                        <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- ì„¹ì…˜ 3: ì„¤ë¬¸ ë° ë™ì˜ -->
        <div class="form-section">
            <h3 class="section-title">ğŸ“ ì„¤ë¬¸ ë° ë™ì˜</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="s_why">ì°¸ì—¬ë™ê¸°</label>
                    <select id="s_why" name="s_why">
                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="ê²½ì œì  ì—¬ìœ ê°€ ìˆì–´ì„œ">ê²½ì œì  ì—¬ìœ ê°€ ìˆì–´ì„œ</option>
                        <option value="ë¶ˆìš°í•œ ì´ì›ƒì„ ë•ê¸°ìœ„í•´">ë¶ˆìš°í•œ ì´ì›ƒì„ ë•ê¸°ìœ„í•´</option>
                        <option value="ì§€ì—­ì‚¬íšŒë³µì§€ë¥¼ ìœ„í•´">ì§€ì—­ì‚¬íšŒë³µì§€ë¥¼ ìœ„í•´</option>
                        <option value="ì¢…êµì  ì‹ ë…ìœ¼ë¡œ">ì¢…êµì  ì‹ ë…ìœ¼ë¡œ</option>
                        <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="s_path">ì°¸ì—¬ê²½ë¡œ</label>
                    <select id="s_path" name="s_path">
                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="ê¸°ì¡´ í›„ì›ì/ìì›ë´‰ì‚¬ì ì†Œê°œë¥¼ í†µí•´">ê¸°ì¡´ í›„ì›ì/ìì›ë´‰ì‚¬ì ì†Œê°œë¥¼ í†µí•´</option>
                        <option value="ë³µì§€ê´€ ì†Œì‹ì§€ë‚˜ ì•ˆë‚´ë¬¼ì„ í†µí•´">ë³µì§€ê´€ ì†Œì‹ì§€ë‚˜ ì•ˆë‚´ë¬¼ì„ í†µí•´</option>
                        <option value="ì–¸ë¡ ë§¤ì²´ë¥¼ í†µí•´">ì–¸ë¡ ë§¤ì²´ë¥¼ í†µí•´(TV, ë¼ë””ì˜¤, ì‹ ë¬¸ ë“±)</option>
                        <option value="íŠ¹ì • í–‰ì‚¬ ë° ê¸°ë…ì¼ ì¶•í•˜">íŠ¹ì • í–‰ì‚¬ ë° ê¸°ë…ì¼ ì¶•í•˜</option>
                        <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                    </select>
                </div>

                <div class="form-group full-width checkbox-group">
                    <label>í›„ì›ê¸ˆì˜ìˆ˜ì¦ ë° ì—°ë§ì •ì‚°</label>
                    <label class="check-label"><input type="checkbox" name="receipt1" value="í›„ì›ê¸ˆì˜ìˆ˜ì¦ í•„ìš”"> <span>í›„ì›ê¸ˆ ì˜ìˆ˜ì¦
                            ë°œê¸‰ í•„ìš”</span></label>
                    <label class="check-label"><input type="checkbox" name="receipt2" value="êµ­ì„¸ì²­ ì—°ë§ì •ì‚° ê°„ì†Œí™” í›„ì›ë‚´ì—­ ì œê³µ ë™ì˜">
                        <span>êµ­ì„¸ì²­ ì—°ë§ì •ì‚° ê°„ì†Œí™” ìë£Œ ì œê³µ ë™ì˜</span></label>
                </div>

                <div class="form-group">
                    <label for="a_date">ì‹ ì²­ì¼ì</label>
                    <input type="date" id="a_date" name="a_date">
                </div>
            </div>
        </div>

        <!-- ì„¹ì…˜ 4: ì„œëª… -->
        <div class="form-section">
            <h3 class="section-title">âœï¸ ì„œëª…</h3>
            <div class="signature-container">
                <canvas id="sig"></canvas>
                <button type="button" id="clearSig" class="btn-clear">ë‹¤ì‹œ ì“°ê¸°</button>
            </div>
        </div>

        <div class="form-actions">
            <button type="button" onclick="submitData()" class="btn-submit">í›„ì› ì‹ ì²­í•˜ê¸°</button>
            <p class="submit-note">â€» ì œì¶œ ì™„ë£Œê¹Œì§€ ì•½ê°„ì˜ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

    </form>

    <div id="loadingMessage" class="status-overlay">
        <div class="spinner"></div>
        <p>ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
    </div>
    <div id="savingMessage" class="status-overlay">
        <div class="spinner"></div>
        <p>ì‹ ì²­ì„œë¥¼ ì•ˆì „í•˜ê²Œ ì €ì¥ ì¤‘ì…ë‹ˆë‹¤...</p>
    </div>
</div>

<style>
    /* ë¡œì»¬ ìŠ¤íƒ€ì¼ ì •ì˜ (style.cssë¡œ ì´ë™ ê¶Œì¥) */
    .styled-form {
        max-width: 800px;
        margin: 0 auto;
        background: #fff;
        padding: 40px;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .form-section {
        margin-bottom: 40px;
        border-bottom: 1px solid #eee;
        padding-bottom: 30px;
    }

    .form-section:last-child {
        border-bottom: none;
    }

    .section-title {
        font-size: 1.2rem;
        color: #4285f4;
        margin-bottom: 20px;
        border-left: 4px solid #4285f4;
        padding-left: 10px;
        font-weight: 700;
    }

    .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px 30px;
    }

    /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
    @media (max-width: 768px) {
        .form-grid {
            grid-template-columns: 1fr;
        }

        .styled-form {
            padding: 20px;
        }
    }

    .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .full-width {
        grid-column: 1 / -1;
    }

    label {
        font-weight: 600;
        font-size: 0.95rem;
        color: #444;
    }

    .required {
        color: #ea4335;
    }

    input[type="text"],
    input[type="number"],
    input[type="password"],
    input[type="email"],
    input[type="date"],
    select {
        padding: 10px 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 1rem;
        transition: border-color 0.2s;
    }

    input:focus,
    select:focus {
        border-color: #4285f4;
        outline: none;
        box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.2);
    }

    /* Input with Button */
    .input-with-button {
        display: flex;
        gap: 10px;
    }

    .input-with-button input {
        flex: 1;
    }

    .btn-check {
        padding: 0 15px;
        background: #f1f3f4;
        border: 1px solid #dcdcdc;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        color: #555;
        white-space: nowrap;
    }

    .btn-check:hover {
        background: #e8eaed;
    }

    /* SSN Group */
    .ssn-group {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .ssn-group input {
        width: 120px;
        text-align: center;
        letter-spacing: 2px;
    }

    .dash {
        color: #999;
    }

    /* Radio Group */
    .radio-group {
        display: flex;
        gap: 20px;
        padding: 10px 0;
    }

    .radio-group.wrap {
        flex-wrap: wrap;
    }

    .radio-label {
        display: flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
    }

    .radio-label input {
        accent-color: #4285f4;
        width: 18px;
        height: 18px;
    }

    /* Item Inputs */
    .item-inputs {
        display: grid;
        grid-template-columns: 2fr 1fr 1fr;
        gap: 10px;
    }

    /* Checkbox Group */
    .checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 10px;
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
    }

    .check-label {
        display: flex;
        align-items: center;
        gap: 10px;
        cursor: pointer;
    }

    .check-label input {
        width: 18px;
        height: 18px;
        accent-color: #4285f4;
    }

    /* Signature */
    .signature-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
    }

    #sig {
        background: #f8f9fa;
        border: 2px dashed #ccc;
        border-radius: 8px;
        cursor: crosshair;
        width: 100%;
        max-width: 500px;
        height: 250px;
    }

    .btn-clear {
        padding: 8px 16px;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 4px;
        color: #666;
        cursor: pointer;
        font-size: 0.9rem;
    }

    /* Submit Button */
    .form-actions {
        text-align: center;
        margin-top: 20px;
    }

    .btn-submit {
        background: #4285f4;
        color: white;
        border: none;
        padding: 15px 50px;
        font-size: 1.2rem;
        font-weight: 700;
        border-radius: 30px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(66, 133, 244, 0.3);
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .btn-submit:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(66, 133, 244, 0.4);
    }

    .submit-note {
        margin-top: 10px;
        font-size: 0.85rem;
        color: #888;
    }

    /* Overlay */
    .status-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.9);
        z-index: 9999;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #3498db;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
    }

    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/signature_pad@5.0.3/dist/signature_pad.umd.min.js"></script>
<script>
    var signaturePad;

    function setupSignatureBox() {
        var canvas = document.getElementById("sig");

        // ë°˜ì‘í˜• ìº”ë²„ìŠ¤ ë¦¬ì‚¬ì´ì§•
        function resizeCanvas() {
            var ratio = Math.max(window.devicePixelRatio || 1, 1);
            // ìº”ë²„ìŠ¤ ë„ˆë¹„ëŠ” ë¶€ëª¨ ì»¨í…Œì´ë„ˆì— ë§ì¶¤, ìµœëŒ€ 500px ëŒ€ëµ
            var containerWidth = canvas.parentElement.offsetWidth;
            canvas.width = Math.min(containerWidth, 500) * ratio;
            canvas.height = 250 * ratio; // ë†’ì´ ê³ ì •
            canvas.getContext("2d").scale(ratio, ratio);

            // CSS ì‚¬ì´ì¦ˆ ì¡°ì •
            canvas.style.width = Math.min(containerWidth, 500) + "px";
            canvas.style.height = "250px";
        }

        window.addEventListener("resize", resizeCanvas);
        resizeCanvas();

        signaturePad = new SignaturePad(canvas);
    }

    function clearSignature() {
        signaturePad.clear();
    }

    function submitData() {
        const form = document.getElementById('donationForm');
        const formData = new FormData(form);

        // í•„ìˆ˜ ì…ë ¥ í•„ë“œ í™•ì¸
        if (!formData.get('name') || !formData.get('ssn_a') || !formData.get('ssn_b') || !formData.get('cphone_n') || signaturePad.isEmpty()) {
            alert('ì„±ëª…, ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸, ì—°ë½ì²˜, ì„œëª…ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
            return;
        }

        const data = {
            name: formData.get('name'),
            gender: formData.get('gender'),
            ssn_a: formData.get('ssn_a'),
            ssn_b: formData.get('ssn_b'),
            cphone_n: formData.get('cphone_n'),
            phone_n: formData.get('phone_n'),
            address: formData.get('address'),
            e_mail: formData.get('e_mail'),
            s_term: formData.get('s_term'),
            s_type: formData.get('s_type'),
            s_money: formData.get('s_money'),
            s_how: formData.get('s_how'),
            s_item: formData.get('s_item'),
            s_item_q: formData.get('s_item_q'),
            s_unit: formData.get('s_unit'),
            s_sector: formData.get('s_sector'),
            s_why: formData.get('s_why'),
            s_path: formData.get('s_path'),
            receipt1: formData.get('receipt1') ? 'í•„ìš”' : 'ë¶ˆí•„ìš”',
            receipt2: formData.get('receipt2') ? 'ë™ì˜' : 'ë¯¸ë™ì˜',
            a_date: formData.get('a_date'),
            signature: signaturePad.toDataURL()
        };

        const savingMsg = document.getElementById('savingMessage');
        savingMsg.style.display = 'flex'; // ì €ì¥ ì¤‘ ë©”ì‹œì§€ í‘œì‹œ

        // Check availability of google.script.run
        if (typeof google === 'undefined' || typeof google.script === 'undefined') {
            console.warn('google.script.run is unavailable. Running in simulation mode.');
            setTimeout(() => {
                savingMsg.style.display = 'none';
                alert('[ì‹œë®¬ë ˆì´ì…˜] ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\n(ì‹¤ì œ ì €ì¥ë˜ë ¤ë©´ Google Apps Script í™˜ê²½ì´ í•„ìš”í•©ë‹ˆë‹¤)');
            }, 1500);
            return;
        }

        google.script.run.withSuccessHandler(() => {
            savingMsg.style.display = 'none';
            alert('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }).withFailureHandler(error => {
            savingMsg.style.display = 'none';
            console.error('Error:', error);
            alert('ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        }).sendUserData(
            data.name, data.gender, data.ssn_a, data.ssn_b, data.cphone_n, data.phone_n,
            data.address, data.e_mail, data.s_term, data.s_type, data.s_money, data.s_how,
            data.s_item, data.s_item_q, data.s_unit, data.s_sector, data.s_why, data.s_path,
            data.receipt1, data.receipt2, data.a_date, data.signature
        );
    }

    function autofillForm() {
        const name = document.getElementById('name').value;
        const loadingMsg = document.getElementById('loadingMessage');
        loadingMsg.style.display = 'flex'; // ë¡œë”© ë©”ì‹œì§€ í‘œì‹œ

        if (typeof google === 'undefined' || typeof google.script === 'undefined') {
            setTimeout(() => {
                loadingMsg.style.display = 'none';
                alert('[ì‹œë®¬ë ˆì´ì…˜] í•´ë‹¹ ì´ë¦„ì˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n(ì‹¤ì œ ê²€ìƒ‰í•˜ë ¤ë©´ Google Apps Script í™˜ê²½ì´ í•„ìš”í•©ë‹ˆë‹¤)');
            }, 1000);
            return;
        }

        google.script.run.withSuccessHandler(fillForm).getUserDataByName(name);
    }

    function fillForm(data) {
        document.getElementById('loadingMessage').style.display = 'none'; // ë¡œë”© ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
        if (data) {
            document.getElementById('ssn_a').value = data.ssn_a;
            document.getElementById('address').value = data.address;
            document.getElementById('cphone_n').value = data.cphone_n;
            document.getElementById('phone_n').value = data.phone_n;

            // ì„±ë³„ í•„ë“œ ì—…ë°ì´íŠ¸
            if (data.gender === 'ë‚¨') {
                document.querySelector('input[name="gender"][value="ë‚¨"]').checked = true;
            } else if (data.gender === 'ì—¬') {
                document.querySelector('input[name="gender"][value="ì—¬"]').checked = true;
            }
        } else {
            alert('í•´ë‹¹ ì´ë¦„ì˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
    }

    document.getElementById("clearSig").addEventListener("click", clearSignature);

    // ì„œëª… íŒ¨ë“œ ì´ˆê¸°í™”ëŠ” DOMì´ ë¡œë“œëœ í›„ ì‹¤í–‰
    // loadModuleë¡œ ë¶ˆëŸ¬ì˜¬ ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ ì•½ê°„ì˜ ì§€ì—° ë˜ëŠ” ì§ì ‘ í˜¸ì¶œ ê³ ë ¤
    setTimeout(setupSignatureBox, 100); 
</script>